# Metasploit Exploitation

## Abstract
Throughout the exploitation process, various virtual machines (VMs) were used to identify and exploit vulnerabilities. The VMs included Kali, Metasploitable Linux, Metasploitable Win2k8, and Windows XP. Nmap scans with the vulners script were performed to categorize vulnerabilities by CVE. Specific CVEs were chosen for exploitation based on their potential impact and ease of exploitation.

## VM IPs
- **Kali IP**: 192.168.48.129
- **Metasploitable Linux IP**: 192.168.48.130
- **Metasploitable Win2k8 IP**: 192.168.48.132
- **Windows XP IP**: 192.168.48.131


### Windows XP
- **Chosen Exploit**: CVE-2008-4250
- **CVE Details**: MS08-067 Microsoft Server Service Relative Path Stack Corruption. This vulnerability is found in Windows XP MS08 versions and exploits the NetAPI32.dll through Server Service. It is exploited after a crafted RPC request triggers the overflow during path canonicalization.
- **CVE Page**: CVE-2008-4250 on cve.mitre.org

## Metasploitable Linux
To easily organize the scan and categorize it by CVEs, I ran an Nmap scan using the vulners script and outputted the results to a file called `Metasplinmapvuln.txt`.
![image](https://github.com/user-attachments/assets/98eb99ec-1bf0-4e47-916f-512d9459743c)

I then grepped the file to find the lines that include "CVE". I chose to exploit **CVE-2011-2523**, an input validation vulnerability that opens a backdoor/reverse shell on port 6200/tcp. After researching the CVE on the cve.mitre.org page, I learned that this vulnerability is exposed to vsftpd version 2.3.4.
![image](https://github.com/user-attachments/assets/a7f2bdfb-c4d8-4b98-8f18-aa6668f9a16a)

- **Chosen Exploit**: CVE-2011-2523
- **CVE Details**: An input validation vulnerability that opens a backdoor/reverse shell on port 6200/tcp. This vulnerability is exposed to vsftpd version 2.3.4.
- **CVE Page**: CVE-2011-2523 on cve.mitre.org
![image](https://github.com/user-attachments/assets/e3fd96fe-d84f-49f7-af31-b7ca2e6405c8)


### Exploitation

- The first step is to search for a payload correlated with the vulnerability
- We will then find the available/required options within the payload
![image](https://github.com/user-attachments/assets/66cd940d-6556-49cb-9949-303a3ec706c0)
- After setting the options, we can exploit the payload using the run command
![image](https://github.com/user-attachments/assets/5c61c125-efbe-424b-919b-b247bacc7b0d)


## Metasploitable Win2k8
To easily organize the scan and categorize it by CVEs, I ran an Nmap scan using the vulners script and outputted the results to a file called `Metaspwinmapvuln.txt`.
![image](https://github.com/user-attachments/assets/b249d5ab-ec01-4b71-b245-83db9b7e04e2)

I then grepped the file to find the lines that include "CVE". I chose to exploit **CVE-2014-3120**, found in Elasticsearch version 1.2 and before. This vulnerability enables an attacker to utilize dynamic scripting remotely. After researching the CVE on the cve.mitre.org page, I learned that this vulnerability is exploited by executing arbitrary MVEL expressions and Java code.
![image](https://github.com/user-attachments/assets/b090b53e-f7d9-4ef3-bb6b-58edc06f80fe)

- **Chosen Exploit**: CVE-2014-3120
- **CVE Details**: Found in Elasticsearch version 1.2 and before, this vulnerability enables an attacker to utilize dynamic scripting remotely by executing arbitrary MVEL expressions and Java code.
- **CVE Page**: CVE-2014-3120 on cve.mitre.org
![image](https://github.com/user-attachments/assets/70d4f63f-c496-4e5f-b8ca-c943f2c8fd98)


### Exploitation

- The first step is to search for a payload correlated with the vulnerability
  ![image](https://github.com/user-attachments/assets/9bdf4598-7765-47eb-9c26-8f2e03a3a771)

- We will then find the available/required options within the payload and use `exploit` to execute the payload
![image](https://github.com/user-attachments/assets/43caffda-2060-4fe0-aafd-a163a53856f0)
![image](https://github.com/user-attachments/assets/62cfc897-8c1c-42b2-a30e-f43f7ae27d64)
![image](https://github.com/user-attachments/assets/a9476dba-6279-4738-8283-8eb684a89fde)
- Gathering System Info:
![image](https://github.com/user-attachments/assets/e5407bda-133d-4ea0-bb11-92758eede31b)
- Screenshot:
![image](https://github.com/user-attachments/assets/f749a84a-b237-42dc-940a-205a782bf370)

  
## Windows XP
To easily organize the scan and categorize it by CVEs, I ran an Nmap scan using the vulners script and outputted the results to a file called `winxpnmapvuln.txt`. 
![image](https://github.com/user-attachments/assets/872e539e-1af7-425c-a3b2-783f50b7ca49)

I then grepped the file to find the lines that include "CVE". I chose to exploit **CVE-2008-4250**, which is MS08-067 Microsoft Server Service Relative Path Stack Corruption. This vulnerability is found in Windows XP MS08 versions and exploits the NetAPI32.dll through Server Service. After researching the CVE on the cve.mitre.org page, I learned that this vulnerability is exploited after a crafted RPC request triggers the overflow during path canonicalization.
![image](https://github.com/user-attachments/assets/64a7172c-2ec4-4609-a63e-4b3085e614bd)

- **Chosen Exploit**: CVE-2008-4250
- **CVE Details**: MS08-067 Microsoft Server Service Relative Path Stack Corruption. This vulnerability is found in Windows XP MS08 versions and exploits the NetAPI32.dll through Server Service. It is exploited after a crafted RPC request triggers the overflow during path canonicalization.
- **CVE Page**: CVE-2008-4250 on cve.mitre.org
![image](https://github.com/user-attachments/assets/af67d56d-50ae-4c0f-b8f9-09c91d4741fe)


### Exploitation

- The first step is to search for a payload correlated with the vulnerability
![image](https://github.com/user-attachments/assets/5960c5c2-e14c-4ec0-8400-6c5efee3362d)

- We will then find the available/required options within the payload and use `exploit` to execute the payload
![image](https://github.com/user-attachments/assets/5c14ae53-a143-49fb-9ff4-176df0cabc43)
![image](https://github.com/user-attachments/assets/4909d4d7-b5eb-475a-8ca6-68c038574f13)
![image](https://github.com/user-attachments/assets/4a6bdaef-3b12-44ba-b460-efe918808d73)

  
## Methodology
The exploitation process involved using various virtual machines (VMs) to identify and exploit vulnerabilities. The VMs included Kali, Metasploitable Linux, Metasploitable Win2k8, and Windows XP. Nmap scans with the vulners script were performed to categorize vulnerabilities by CVE. Specific CVEs were chosen for exploitation based on their potential impact and ease of exploitation. Each chosen CVE was researched, and corresponding exploits were executed using appropriate payloads. The process included setting up the payload options and running the exploits to achieve successful exploitation.

## References
- CVE-2011-2523: vsftpd version 2.3.4
- CVE-2014-3120: Elasticsearch version 1.2 and before
- CVE-2008-4250: MS08-067 Microsoft Server Service Relative Path Stack Corruption
